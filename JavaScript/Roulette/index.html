<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>ルーレット的な</title>
    <link rel="stylesheet" type="text/css" href="./style.css">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous">
    </script>
</head>
<body>
    <main>
        <!--ルーレット基盤-->
        <div id="block"></div>

        <!--操作ボタン郡-->
        <div id="control">
            <input type="button" value="START" id="start">
		    <input type="button" value="STOP" id="stop">
            <input type="button" value="RESET" id="reset">
        </div>
    </main>
    
    <script>
        class Roulette{
            constructor(size){
                this.currentNum = 0;
                this.maxSize = size;
                this.memory = [];

                for(let i=0 ; i<this.maxSize ; i++){
                    this.memory.push(i+1);
                }
            }

            //マスの生成
            initialize(elementId){
                for(let i=0; i<this.maxSize ; i++){
                    $(elementId).append(`<div class = "block" id="blockId${i}">${i+1}</div>`);
                }
            }

            //ルーレット一回分のコールバクメソッド
            work(){
                console.log(this.memory);
                //メモリーの要素数を上限とした乱数作成
                $(".block").css("background-color", "White");
                this.currentNum = Math.floor(Math.random(new Date().getTime()) * this.memory.length) + 1;
                $(`#blockId${this.currentNum}`).css("background-color", "Orange");
            }

            //ルーレット停止
            save(){
                this.memory = this.memory.map((n) => n !== this.currentNum);
                $(`#blockId${this.currentNum}`).addClass("checked");
            }

            //初期化
            clear(){
                $(".block")
                    .removeClass("checked")
                    .css("background-color", "White");
            }
        }

        //タイマー
        let timer = null;

        $(()=>{
            let rule = new Roulette(16);

            //初期化
            rule.initialize("#block");

            //スタートボタン押下
            $("#start").click(() => {
                clearInterval(timer);
                timer = setInterval(()=>{rule.work()}, 100);
            });

            //ストップボタン押下
            $("#stop").click(() => {
                clearInterval(timer);
                rule.save();
            });

            //リセットボタン押下
            $("#reset").click(() => {
                clearInterval(timer);
                rule.clear();
            });
        });
    </script>
</body>
</html>